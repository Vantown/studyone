!function(t,e){function n(t){var e={QueryString:function(t){var e=window.location.href,n=new RegExp("[&?]{1}"+t+"=([^&?|^#?]*)","ig");return e.match(n)?decodeURI(e.match(n)[0].substr(t.length+2)):""}};return e.QueryString(t)}function o(){var e=setInterval(function(){var n=t.ToutiaoJSBridge||{};"function"==typeof n.call&&(n.call("appInfo",{},function(t){t=t||{},l=t.device_id||"",s=t.user_id||""}),clearInterval(e))},1e3)}function i(){var t,e=window.decodeURIComponent(n("_toutiao_params")||"");try{t=JSON.parse(e),l=l||t.device_id||"",s=s||t.uid||""}catch(o){}}function a(){var t="http://nativeapp.toutiao.com"==document.referrer||/(News|NewsSocial|Explore|NewsArticle|NewsInHouse|joke_essay|Joke|Video|VideoInHouse|VideoArticle)( |\/|_)(\d.\d.\d)/i.test(navigator.userAgent);return t}function c(t){var e=[];t=t||{};var n=/^(?:string|boolean|number)/i;for(var o in t)t.hasOwnProperty(o)&&n.test(typeof t[o])&&e.push(o+"="+t[o]);return e.join("&")}function r(t){var e=new XMLHttpRequest;e.open("POST",t.url,!1),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(c(t.data))}function d(){var e=t.location.pathname,n=/\d+/g,o=e.match(n)||[];return o[0]||""}function u(){_++,window.removeTetrisAction("page","stay_time"),window.addTetrisAction({component_type:"page",component_id:d(),action_type:"stay_time",action_value:_+"s"}),window.setTimeout(u,1e3)}function p(){window.addEventListener("load",function(){window.setTimeout(u,1e3);var t=window.screen.availHeight,e=document.body.scrollTop,n=document.documentElement.scrollHeight>document.documentElement.clientHeight?document.documentElement.scrollHeight:document.documentElement.clientHeight,o=t+e;o>n&&(o=n);var i=Math.round(100*o/n)+"%";window.addTetrisAction({component_type:"page",component_id:d(),action_type:"read_pct",action_value:i});var a=!0;window.addEventListener("scroll",function(){a&&(setTimeout(function(){window.removeTetrisAction("page","read_pct");var e=document.body.scrollTop||document.documentElement.scrollTop,o=t+e;o>n&&(o=n);var i=Math.round(100*o/n)+"%";window.addTetrisAction({component_type:"page",component_id:d(),action_type:"read_pct",action_value:i})},500),a=!1)}),window.addTetrisAction({component_type:"page",component_id:d(),action_type:"browse_pages",action_value:Math.ceil(n/t)})})}var s,l,m=[],_=0,v="//ad.toutiao.com/link_monitor/tetris_user_profile";t.addTetrisAction=function(t){m.push({component_type:t.component_type||"",component_id:t.component_id||"",action_type:t.action_type||"",action_value:t.action_value||""})},t.removeTetrisAction=function(t,e){for(var n in m)m[n].component_type===t&&m[n].action_type===e&&m.splice(n,1)},t.addEventListener("click",function(t){for(var n=t.target,o={};n!=e;)n.hasAttribute("tetris-data-click")&&(o.component_type=n.getAttribute("tetris-data-component-type")||"",o.component_id=n.getAttribute("tetris-data-component-id")||"",o.action_type=n.getAttribute("tetris-data-action-type")||"",o.action_valule=n.getAttribute("tetris-data-action-value")||"",m.push(o)),n=n.parentNode},!1),t.addEventListener("unload",function(){if(m.length){var t={};t.device_id=l||"",t.user_id=s||"",t.site_id=d(),t.actions=JSON.stringify(m),r({url:v,data:t})}}),a()?o():i(),p()}(window,document);